# Configuration for Custom Mask R-CNN on iSAID

# Dataset
data:
  root_dir: "iSAID_patches"
  num_classes: 16 # 15 classes + background
  image_size: 800 # Keep 800 for small objects in satellite images

# Model
model:
  pretrained_backbone: true

# RPN Anchor Configuration
anchors:
  # Set optimize to true to run Optuna-based anchor optimization
  optimize: false
  optimization_trials: 20  # Number of Optuna trials
  cache_path: "optimized_anchors.pt"  # Cache file for optimized anchors
  
  # Custom anchor sizes (used only if optimize=false)
  # Each tuple corresponds to an FPN level (P2, P3, P4, P5)
  # Default values are optimized for satellite imagery with small objects
  sizes:
    - [16, 24]   # P2 - smallest objects
    - [32, 48]   # P3
    - [64, 96]   # P4  
    - [128, 192] # P5 - largest objects
  
  # Aspect ratios for each anchor size
  aspect_ratios: [0.5, 1.0, 2.0]

# Training
training:
  epochs: 20
  batch_size: 4
  lr: 0.0001
  amp: true # Mixed precision for memory

# Checkpoints
checkpoint:
  save_dir: "checkpoints"
